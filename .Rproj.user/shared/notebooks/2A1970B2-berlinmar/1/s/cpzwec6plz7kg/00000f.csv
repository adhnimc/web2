"0",""
"0","# Function to convert seconds to HH:MM format"
"0","seconds_to_hhmm <- function(seconds) {"
"0","  hours <- floor(seconds / 3600)"
"0","  minutes <- floor((seconds %% 3600) / 60)"
"0","  sprintf(""%02d:%02d"", hours, minutes)"
"0","}"
"0",""
"0","# Convert time_full to numeric (in seconds) and add HH:MM format for tooltips"
"0","selected_runners <- berlin_2019 %>%"
"0","  mutate("
"0","    time_full_sec = as.numeric(time_full),"
"0","    time_full_hhmm = seconds_to_hhmm(as.numeric(time_full))  # Add formatted time column"
"0","  )"
"0",""
"0","# Plot overlapping histograms for M and W"
"0","p <- ggplot(selected_runners, aes(x = time_full_sec, fill = gender)) +"
"0","  geom_histogram("
"0","    binwidth = 600, alpha = 0.6, position = 'identity',"
"0","    aes(text = paste0("
"0","      ""<b>TIME (HH:MM):</b> "", seconds_to_hhmm(..x..), ""<br>"","
"0","      ""<b>COUNT:</b> "", ..count.., ""<br>"","
"0","      ""<b>GENDER:</b> "", ..fill.."
"0","    )),"
"0","    stat = ""bin"""
"0","  ) +"
"0","  scale_x_continuous("
"0","    limits = c(3600, 25200),  # Setting limits from 1 hour (3600s) to 7 hours (25200s)"
"0","    breaks = seq(3600, 25200, by = 3600),  # Breaks at every hour"
"0","    labels = function(x) sprintf(""%02d:%02d"", floor(x / 3600), floor((x %% 3600) / 60))  # Convert seconds to HH:MM"
"0","  ) +"
"0","  labs("
"0","    title = ""Distribution of Full Marathon Times by Gender"","
"0","    x = ""TIME FULL (HH:MM)"","
"0","    y = ""COUNT"","
"0","    fill = ""GENDER"""
"0","  ) +"
"0","  theme_minimal()"
"2","Warning: [38;5;232mIgnoring unknown aesthetics: [32mtext[38;5;232m[39m"
"0","# Convert to interactive plot with hover text showing the HH:MM format"
"0","interactive_plot <- ggplotly(p, tooltip = ""text"")"
"2","Warning: The dot-dot notation (`..x..`) was deprecated in ggplot2 3.4.0.
Please use `after_stat(x)` instead."
"2","Warning: [38;5;232mRemoved 17 rows containing non-finite outside the scale range (`stat_bin()`).[39m"
"0","# Display the interactive plot"
"0","interactive_plot"
