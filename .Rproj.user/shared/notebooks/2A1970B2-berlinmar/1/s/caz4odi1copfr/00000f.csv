"0",""
"0",""
"0","# Function to convert seconds to HH:MM format"
"0","seconds_to_hhmm <- function(seconds) {"
"0","  hours <- floor(seconds / 3600)"
"0","  minutes <- floor((seconds %% 3600) / 60)"
"0","  sprintf(""%02d:%02d"", hours, minutes)"
"0","}"
"0",""
"0","# Calculate median times, number of runners, and filter countries with at least 10 runners"
"0","berlin_2019 %>%"
"0","  group_by(nationality, gender) %>%"
"0","  summarise("
"0","    median_time = median(as.numeric(time_full), na.rm = TRUE),"
"0","    runner_count = n(),  # Count the number of runners"
"0","    .groups = ""drop"""
"0","  ) %>%"
"0","  pivot_wider("
"0","    names_from = gender,"
"0","    values_from = c(median_time, runner_count),"
"0","    names_prefix = """""
"0","  ) %>%"
"0","  mutate("
"0","    M_hhmm = seconds_to_hhmm(median_time_M),"
"0","    W_hhmm = seconds_to_hhmm(median_time_W),"
"0","    total_runners = runner_count_M + runner_count_W  # Total runners for scaling dot size"
"0","  ) %>%"
"0","  filter(total_runners >= 0) %>%  # Filter countries with fewer than 10 runners"
"0","  ggplot(aes(x = median_time_M, y = median_time_W, label = nationality, size = total_runners,"
"0","             text = paste0(""<b>Country:</b> "", nationality,"
"0","                           ""<br><b>Median Time (Men):</b> "", M_hhmm,"
"0","                           ""<br><b>Median Time (Women):</b> "", W_hhmm,"
"0","                           ""<br><b>Number of Runners:</b> "", total_runners))) +"
"0","  geom_point(aes(color = nationality), alpha = 0.7, position = position_jitter(width = 100, height = 100)) +  # Add jitter"
"0","  scale_size(range = c(3, 10)) +  # Adjust dot size scaling"
"0","  scale_color_viridis_d() +  # Distinct color palette"
"0","  geom_text_repel(aes(label = nationality), max.overlaps = 20, size = 3, color = ""black"") +  # Reduce max overlaps"
"0","  scale_x_continuous("
"0","    labels = seconds_to_hhmm, "
"0","    name = ""Median Time for Men (HH:MM)"","
"0","    limits = c(0, 21600)  # Limit to 3 to 6 hours"
"0","  ) +"
"0","  scale_y_continuous("
"0","    labels = seconds_to_hhmm, "
"0","    name = ""Median Time for Women (HH:MM)"","
"0","    limits = c(0, 21600)  # Limit to 3 to 6 hours"
"0","  ) +"
"0","  labs("
"0","    title = ""Comparison of Median Times: Men vs Women (atleast 20 runners)"","
"0","    subtitle = ""Dot size represents the number of runners"","
"0","    #caption = ""Note: Only countries with more than 10 runners are included."","
"0","    size = ""Number of Runners"","
"0","    color = ""Country"""
"0","  ) +"
"0","  theme_minimal() +"
"0","  theme("
"0","    legend.position = ""none"","
"0","    axis.title = element_text(size = 12, face = ""bold""),"
"0","    axis.text = element_text(size = 10),"
"0","    plot.caption = element_text(hjust = 0.5, size = 10, face = ""italic"")  # Style for the note"
"0","  ) -> p"
"0",""
"0","# Convert to an interactive plot"
"0","ggplotly(p, tooltip = ""text"")"
"2","Warning: geom_GeomTextRepel() has yet to be implemented in plotly.
  If you'd like to see this geom implemented,
  Please open an issue with your example code at
  https://github.com/ropensci/plotly/issues"
